<?xml version="1.0" encoding="UTF-8"?>
<document xmlns:jx="http://apache.org/cocoon/templates/jx/1.0">
    <jx:import uri="context://resources/jxmacros/jxgenerales.xml"/>

    <title>Lista de Clientes</title>

    <columnas No="0" Unit="70"/>
    <columnas No="1" Unit="100"/>
    <columnas No="2" Unit="300"/>
    <columnas No="3" Unit="100"/>
    <columnas No="4" Unit="100"/>
    <columnas No="5" Unit="100"/>
    <columnas No="6" Unit="150"/>
    <columnas No="7" Unit="200"/>
    <columnas No="8" Unit="100"/>
    <columnas No="9" Unit="100"/>
    <columnas No="10" Unit="100"/>

    <jx:set var="fila" value="${1}"/>
    <jx:set var="col" value="${0}"/>
    <jx:set var="colFin" value="${10}"/>
    
    
    <celda Col="${col}" Row="${fila}">LISTA DE CLIENTES</celda>
    <estilo startCol="${col}" startRow="${fila}" endCol="${colFin}" endRow="${fila}" HAlign="64" VAlign="4" Bold="1" Unit="18"/>
	<jx:set var="fila" value="${fila+2}"/>

    
    
    <jx:if test="${colectorId == null}"> 
        <jx:set var="fila" value="${fila+2}"/>
        <celda Col="${col}" Row="${fila}">CONTRATO</celda>
        <celda Col="${col+1}" Row="${fila}">FACTURA INTERNA</celda>
        <celda Col="${col+2}" Row="${fila}">SUSCRIPTOR</celda>
        <celda Col="${col+3}" Row="${fila}">DEPARTAMENTO</celda>
        <celda Col="${col+4}" Row="${fila}">LOCALIDAD</celda>
        <celda Col="${col+5}" Row="${fila}">BARRIO</celda>
        <celda Col="${col+6}" Row="${fila}">SERVICIO</celda>
        <celda Col="${col+7}" Row="${fila}">MES PENDIENTE</celda>
        <celda Col="${col+8}" Row="${fila}">SALDO PENDIENTE</celda>
        <celda Col="${col+9}" Row="${fila}">AVISO NUMERO</celda> 
        <celda Col="${col+10}" Row="${fila}">RECIBIDO (FIRMA)</celda>        
        <estilo startCol="${col}" startRow="${fila}" endCol="${colFin}" endRow="${fila}" HAlign="64" VAlign="4" Bold="1" Recuadro="1"/>
        <jx:set var="fila" value="${fila+1}"/>
        <jx:set var="filaIni" value="${fila}"/> 
    </jx:if>
    
        

    <jx:set var="departamento" value=""/>
      

    <jx:set var="filaInicial" value="${fila}"/>

    <jx:forEach var="item" items="${bean}" varStatus="status">
    <jx:set var="mes" value="${util.getMes(item[0])}"/> 
    <jx:set var="saldo" value="${util.getMontoPendiente(item[0])}"/> 
    <jx:if test="departamento != item[4]}">    	
	   <!-- <jx:if test="${colectorId != null}">   -->   
	        <celda Col="${col}" Row="${fila}">Departamento: ${item[3]} </celda>
	        <estilo startCol="${col}" startRow="${fila}" endCol="${colFin}" endRow="${fila}" HAlign="64" VAlign="4" Bold="1" Unit="16" Recuadro="1"/>        
       
        
        <jx:set var="fila" value="${fila+2}"/>
        <celda Col="${col}" Row="${fila}">CONTRATO</celda>
        <celda Col="${col+1}" Row="${fila}">FACTURA INTERNA</celda>
        <celda Col="${col+2}" Row="${fila}">SUSCRIPTOR</celda>
        <celda Col="${col+3}" Row="${fila}">DEPARTAMENTO</celda>
        <celda Col="${col+4}" Row="${fila}">LOCALIDAD</celda>
        <celda Col="${col+5}" Row="${fila}">BARRIO</celda>
        <celda Col="${col+6}" Row="${fila}">SERVICIO</celda>
        <celda Col="${col+7}" Row="${fila}">MES PENDIENTE</celda>
        <celda Col="${col+8}" Row="${fila}">SALDO PENDIENTE</celda>
        <celda Col="${col+9}" Row="${fila}">AVISO NUMERO</celda> 
        <celda Col="${col+10}" Row="${fila}">RECIBIDO (FIRMA)</celda> 
        <estilo startCol="${col}" startRow="${fila}" endCol="${colFin}" endRow="${fila}" HAlign="64" VAlign="4" Bold="1" Unit="14" Recuadro="1"/>
        <jx:set var="fila" value="${fila+1}"/>
        <jx:set var="filaIni" value="${fila}"/> 
         <!-- </jx:if> -->
 </jx:if>
    
    <jx:set var="departamento" value="${item[4]}"/>
    <celda Col="${col}" Row="${fila}">${item[0]}</celda>
    <celda Col="${col+1}" Row="${fila}">${item[1]}</celda>
    <celda Col="${col+2}" Row="${fila}">${item[2]}</celda>
    <celda Col="${col+3}" Row="${fila}">${item[3]}</celda>
    <celda Col="${col+4}" Row="${fila}">${item[4]}</celda>
    <celda Col="${col+5}" Row="${fila}">${item[11]}</celda>
    <celda Col="${col+6}" Row="${fila}">${item[5]}</celda>
    <celda Col="${col+7}" Row="${fila}">${mes}</celda>
    <celda Col="${col+8}" Row="${fila}">${saldo}</celda>
    <celda Col="${col+9}" Row="${fila}"><blanco/></celda>
    <celda Col="${col+10}" Row="${fila}"><blanco/></celda>
        <estilo startCol="${col}" startRow="${fila}" endCol="${colFin}" endRow="${fila}" HAlign="64" VAlign="4" Recuadro="1"/>    
    <jx:set var="fila" value="${fila+1}"/>
    
    </jx:forEach>
</document>