<?xml version="1.0" encoding="UTF-8"?>
<fd:form xmlns:fd="http://apache.org/cocoon/forms/1.0#definition"
	     xmlns:i18n="http://apache.org/cocoon/i18n/2.1">
	<fd:widgets>
        <fd:field id="usrId" state="output">
			<fd:label>Supervisor: </fd:label>
			<fd:datatype base="integer" />
			<fd:selection-list src="cocoon:/supervisor.combo"
				cache="none" />			
		</fd:field>

        <fd:field id="pagoFecha" required="true">
            <fd:label>Fecha: </fd:label>
            <fd:datatype base="date">
				<fd:convertor type="formatting" variant="date">
					<fd:patterns>
						<fd:pattern>dd/MM/yyyy</fd:pattern>
					</fd:patterns>
				</fd:convertor>
			</fd:datatype>			
        </fd:field>
        
        <fd:field id="colectorId" required="true">
    		<fd:label>Colector: </fd:label>    
			<fd:datatype base="integer"/>
			<fd:selection-list src="cocoon:/colector.combo"
				cache="none" />	
		</fd:field>
       
		<!-- Detalle Cantidad -->
		
		<fd:repeater id="detalleCantidad">
            <fd:widgets>
                
                <fd:field id="cantidadId">
                	<fd:label>Denominacion</fd:label>
					<fd:datatype base="integer"/>
					<fd:selection-list src="cocoon:/cantidadcs.combo"
						cache="none" />
					<fd:on-value-changed>
						<fd:javascript>
							alSeleccionarCantidad(event);
						</fd:javascript>
					</fd:on-value-changed>					
				</fd:field>
				
				<fd:field id="cantidadValor" required="true">
					<fd:datatype base="integer"/>								
				</fd:field>
				
				<fd:field id="cantidad" required="true">
					<fd:label>Cantidad</fd:label>			
					<fd:datatype base="integer"/>
					<fd:on-value-changed>
						<fd:javascript>
							alSeleccionarValor(event);
						</fd:javascript>
					</fd:on-value-changed>			
				</fd:field>
				
				  <fd:field id="total" state="output">
                    <fd:label>Total</fd:label>
                    <fd:hint>Total</fd:hint>
                    <fd:datatype base="decimal">
                        <fd:convertor type="formatting" variant="number">
                            <fd:patterns>
                                <fd:pattern>#,##0.00</fd:pattern>
                            </fd:patterns>
                        </fd:convertor>
                    </fd:datatype>                 
                </fd:field>
				
				

	        	<fd:booleanfield id="marcar">
					<fd:label>Seleccionar</fd:label>
					<fd:hint>Selecciona el registro.</fd:hint>
					<fd:help>
						Los registros seleccionados serán eliminados del
						formulario cuando se haga click en el botón
						<b>Eliminar</b>
					</fd:help>
				</fd:booleanfield>
				</fd:widgets>
			</fd:repeater>

			<fd:repeater-action id="agregar" command="add-row"
				repeater="detalleCantidad">
				<fd:label>Agregar</fd:label>
				<fd:hint>
					Haga click en el botón para agregar un registro.
				</fd:hint>
			</fd:repeater-action>

			<fd:repeater-action id="eliminar" command="delete-rows"
				repeater="detalleCantidad" select="marcar">
				<fd:label>Eliminar</fd:label>
				<fd:hint>
					Haga click en el botón para eliminar los registros
					seleccionados.
				</fd:hint>
			</fd:repeater-action>
			
			
			<!-- Detalle Cantidad Us -->
		
		<fd:repeater id="detalleCantidadUs" initial-size="1">
            <fd:widgets>
                
                <fd:field id="cantidadIdUs">
                	<fd:label>Denominacion</fd:label>
					<fd:datatype base="integer"/>
					<fd:selection-list src="cocoon:/cantidadus.combo"
						cache="none" />						
				</fd:field>
				
				<fd:field id="cantidadUs" required="true">
					<fd:label>Cantidad</fd:label>			
					<fd:datatype base="integer"/>			
				</fd:field>
				
				<fd:calculatedfield id="totalUs" state="output">
                    <fd:label>Total</fd:label>
                    <fd:hint>Total</fd:hint>
                    <fd:datatype base="decimal">
                        <fd:convertor type="formatting" variant="number">
                            <fd:patterns>
                                <fd:pattern>#,##0.00</fd:pattern>
                            </fd:patterns>
                        </fd:convertor>
                    </fd:datatype>
                    <fd:value type="javascript" triggers="cantidadIdUs, cantidadUs">
			            var subTotal = java.math.BigDecimal.ZERO;
			            var handler = new Packages.com.metropolitana.multipagos.forms.cantidades.CantidadHandler();
			            var handlerUtil = new Packages.com.metropolitana.multipagos.forms.Util();
			            var cantidadId = form.getChild("cantidadIdUs").getValue();
			            var cantidad = form.getChild("cantidadUs").getValue();
			            var cantd = handler.retrieve(cantidadId);
			            subTotal = handlerUtil.calcularTotalCantidad(cantd.getCantidadValor(), cantidad);
			            
			            return subTotal;
		            </fd:value>
                </fd:calculatedfield>
				
				

	        	<fd:booleanfield id="marcar-us">
					<fd:label>Seleccionar</fd:label>
					<fd:hint>Selecciona el registro.</fd:hint>
					<fd:help>
						Los registros seleccionados serán eliminados del
						formulario cuando se haga click en el botón
						<b>Eliminar</b>
					</fd:help>
				</fd:booleanfield>
				</fd:widgets>
			</fd:repeater>

			<fd:repeater-action id="agregar-us" command="add-row"
				repeater="detalleCantidadUs">
				<fd:label>Agregar</fd:label>
				<fd:hint>
					Haga click en el botón para agregar un registro.
				</fd:hint>
			</fd:repeater-action>

			<fd:repeater-action id="eliminar-us" command="delete-rows"
				repeater="detalleCantidadUs" select="marcar">
				<fd:label>Eliminar</fd:label>
				<fd:hint>
					Haga click en el botón para eliminar los registros
					seleccionados.
				</fd:hint>
			</fd:repeater-action>
			
			
			<!-- Detalle Cheque -->
			
			<fd:repeater id="detalleCheque" initial-size="1">
            <fd:widgets>
                
                <fd:field id="bancoId">
                	<fd:label>Banco</fd:label>
					<fd:datatype base="integer"/>
					<fd:selection-list src="cocoon:/banco.combo"
						cache="none" />										
				</fd:field>
				
				<fd:field id="nCheque" required="true">
					<fd:label>No. Cheque</fd:label>			
					<fd:datatype base="integer"/>			
				</fd:field>
				
				<fd:booleanfield id="dolares">
					<fd:label>Dolares</fd:label>
					<fd:on-value-changed>
						<fd:javascript>
							pagoEnDolares(event);
						</fd:javascript>
					</fd:on-value-changed>					
				</fd:booleanfield>
				
				<fd:field id="beneficiario" required="true">
					<fd:label>Beneficiario </fd:label>					
					<fd:datatype base="string" />
				</fd:field>
				
				<fd:field id="montoCs">
		            <fd:label>Monto (C$)</fd:label>
		            <fd:datatype base="decimal">
		                <fd:convertor type="formatting" variant="number">
		                    <fd:patterns>
		                        <fd:pattern>#,##0.00</fd:pattern>
		                    </fd:patterns>
		                </fd:convertor>
		            </fd:datatype>
		            <fd:validation>
		                <fd:assert test="montoCs &gt;0.00">
		                    <fd:failmessage>
		                        <i18n:text>com.metropolitana.key.mayorquecero</i18n:text>
		                    </fd:failmessage>
		                </fd:assert>
		            </fd:validation>
		        </fd:field>
		        
		        <fd:field id="montoUs" state="invisible">
		            <fd:label>Monto (U$)</fd:label>
		            <fd:datatype base="decimal">
		                <fd:convertor type="formatting" variant="number">
		                    <fd:patterns>
		                        <fd:pattern>#,##0.00</fd:pattern>
		                    </fd:patterns>
		                </fd:convertor>
		            </fd:datatype>
		            <fd:validation>
		                <fd:assert test="montoUs &gt;0.00">
		                    <fd:failmessage>
		                        <i18n:text>com.metropolitana.key.mayorquecero</i18n:text>
		                    </fd:failmessage>
		                </fd:assert>
		            </fd:validation>
		        </fd:field>
		        
		        <fd:field id="conversion" required="true">
		            <fd:label>Conversion</fd:label>
		            <fd:datatype base="decimal">
		                <fd:convertor type="formatting" variant="number">
		                    <fd:patterns>
		                        <fd:pattern>#,##0.00</fd:pattern>
		                    </fd:patterns>
		                </fd:convertor>
		            </fd:datatype>
		            <fd:validation>
		                <fd:assert test="conversion &gt;0.00">
		                    <fd:failmessage>
		                        <i18n:text>com.metropolitana.key.mayorquecero</i18n:text>
		                    </fd:failmessage>
		                </fd:assert>
		            </fd:validation>
		        </fd:field>
				
	        	<fd:booleanfield id="marcar-cheque">
					<fd:label>Seleccionar</fd:label>
					<fd:hint>Selecciona el registro.</fd:hint>
					<fd:help>
						Los registros seleccionados serán eliminados del
						formulario cuando se haga click en el botón
						<b>Eliminar</b>
					</fd:help>
				</fd:booleanfield>
				</fd:widgets>
			</fd:repeater>

			<fd:repeater-action id="agregar-cheque" command="add-row"
				repeater="detalleCheque">
				<fd:label>Agregar</fd:label>
				<fd:hint>
					Haga click en el botón para agregar un registro.
				</fd:hint>
			</fd:repeater-action>

			<fd:repeater-action id="eliminar-cheque" command="delete-rows"
				repeater="detalleCheque" select="marcar">
				<fd:label>Eliminar</fd:label>
				<fd:hint>
					Haga click en el botón para eliminar los registros
					seleccionados.
				</fd:hint>
			</fd:repeater-action>
			
			
			<!-- Detalle Depositos -->
			
			<fd:repeater id="detalleDepositos">
            <fd:widgets>
                <fd:booleanfield id="dolares">
					<fd:label>Dolares</fd:label>
					<fd:on-value-changed>
						<fd:javascript>
							depositoEnDolares(event);
						</fd:javascript>
					</fd:on-value-changed>					
				</fd:booleanfield>
				
				<fd:field id="cuentaCs">
					<fd:label>Cuenta (C$)</fd:label>			
					<fd:datatype base="integer"/>			
				</fd:field>
				
				<fd:field id="cuentaUs" state="invisible">
					<fd:label>Cuenta (U$)</fd:label>			
					<fd:datatype base="integer"/>			
				</fd:field>
				
				<fd:field id="referencia" required="true">
					<fd:label>Referencia </fd:label>					
					<fd:datatype base="string" />
				</fd:field>
				
				<fd:field id="montoCs">
		            <fd:label>Monto (C$)</fd:label>
		            <fd:datatype base="decimal">
		                <fd:convertor type="formatting" variant="number">
		                    <fd:patterns>
		                        <fd:pattern>#,##0.00</fd:pattern>
		                    </fd:patterns>
		                </fd:convertor>
		            </fd:datatype>
		            <fd:validation>
		                <fd:assert test="montoCs &gt;0.00">
		                    <fd:failmessage>
		                        <i18n:text>com.metropolitana.key.mayorquecero</i18n:text>
		                    </fd:failmessage>
		                </fd:assert>
		            </fd:validation>
		        </fd:field>
		        
		        <fd:field id="montoUs" state="invisible">
		            <fd:label>Monto (U$)</fd:label>
		            <fd:datatype base="decimal">
		                <fd:convertor type="formatting" variant="number">
		                    <fd:patterns>
		                        <fd:pattern>#,##0.00</fd:pattern>
		                    </fd:patterns>
		                </fd:convertor>
		            </fd:datatype>
		            <fd:validation>
		                <fd:assert test="montoUs &gt;0.00">
		                    <fd:failmessage>
		                        <i18n:text>com.metropolitana.key.mayorquecero</i18n:text>
		                    </fd:failmessage>
		                </fd:assert>
		            </fd:validation>
		        </fd:field>
		        
		        <fd:field id="conversion" required="true">
		            <fd:label>Conversion</fd:label>
		            <fd:datatype base="decimal">
		                <fd:convertor type="formatting" variant="number">
		                    <fd:patterns>
		                        <fd:pattern>#,##0.00</fd:pattern>
		                    </fd:patterns>
		                </fd:convertor>
		            </fd:datatype>
		            <fd:validation>
		                <fd:assert test="conversion &gt;0.00">
		                    <fd:failmessage>
		                        <i18n:text>com.metropolitana.key.mayorquecero</i18n:text>
		                    </fd:failmessage>
		                </fd:assert>
		            </fd:validation>
		        </fd:field>
				
	        	<fd:booleanfield id="marcar-deposito">
					<fd:label>Seleccionar</fd:label>
					<fd:hint>Selecciona el registro.</fd:hint>
					<fd:help>
						Los registros seleccionados serán eliminados del
						formulario cuando se haga click en el botón
						<b>Eliminar</b>
					</fd:help>
				</fd:booleanfield>
				</fd:widgets>
			</fd:repeater>

			<fd:repeater-action id="agregar-deposito" command="add-row"
				repeater="detalleDepositos">
				<fd:label>Agregar</fd:label>
				<fd:hint>
					Haga click en el botón para agregar un registro.
				</fd:hint>
			</fd:repeater-action>

			<fd:repeater-action id="eliminar-deposito" command="delete-rows"
				repeater="detalleDepositos" select="marcar">
				<fd:label>Eliminar</fd:label>
				<fd:hint>
					Haga click en el botón para eliminar los registros
					seleccionados.
				</fd:hint>
			</fd:repeater-action>
			
			
			<fd:field id="totalCs" state="output">
            <fd:label>Total Efectivo (C$):</fd:label>
            <fd:datatype base="decimal">
                <fd:convertor type="formatting" variant="number">
                    <fd:patterns>
                        <fd:pattern>#,##0.00</fd:pattern>
                    </fd:patterns>
                </fd:convertor>
            </fd:datatype>
        </fd:field>
        
        <fd:field id="totalUs" state="output">
            <fd:label>Total Efectivo (U$):</fd:label>
            <fd:datatype base="decimal">
                <fd:convertor type="formatting" variant="number">
                    <fd:patterns>
                        <fd:pattern>#,##0.00</fd:pattern>
                    </fd:patterns>
                </fd:convertor>
            </fd:datatype>
        </fd:field>
        
        <fd:field id="conversionUs" state="output">
            <fd:label>Conversion (U$):</fd:label>
            <fd:datatype base="decimal">
                <fd:convertor type="formatting" variant="number">
                    <fd:patterns>
                        <fd:pattern>#,##0.00</fd:pattern>
                    </fd:patterns>
                </fd:convertor>
            </fd:datatype>
        </fd:field>
        
        
        <fd:field id="totalCkCs" state="output">
            <fd:label>Total CK (C$):</fd:label>
            <fd:datatype base="decimal">
                <fd:convertor type="formatting" variant="number">
                    <fd:patterns>
                        <fd:pattern>#,##0.00</fd:pattern>
                    </fd:patterns>
                </fd:convertor>
            </fd:datatype>
        </fd:field>
        
        <fd:field id="totalCkUs" state="output">
            <fd:label>Total CK (U$):</fd:label>
            <fd:datatype base="decimal">
                <fd:convertor type="formatting" variant="number">
                    <fd:patterns>
                        <fd:pattern>#,##0.00</fd:pattern>
                    </fd:patterns>
                </fd:convertor>
            </fd:datatype>
        </fd:field>
        
        <fd:field id="conversionCkUs" state="output">
            <fd:label>Conversion CK (U$):</fd:label>
            <fd:datatype base="decimal">
                <fd:convertor type="formatting" variant="number">
                    <fd:patterns>
                        <fd:pattern>#,##0.00</fd:pattern>
                    </fd:patterns>
                </fd:convertor>
            </fd:datatype>
        </fd:field>
        
        
        <!-- ooooooooooooooooooooooooooooooooooooooooo -->
			
		<fd:field id="totalDpCs" state="output">
            <fd:label>Total DP (C$):</fd:label>
            <fd:datatype base="decimal">
                <fd:convertor type="formatting" variant="number">
                    <fd:patterns>
                        <fd:pattern>#,##0.00</fd:pattern>
                    </fd:patterns>
                </fd:convertor>
            </fd:datatype>
        </fd:field>
        
        <fd:field id="totalDpUs" state="output">
            <fd:label>Total DP (U$):</fd:label>
            <fd:datatype base="decimal">
                <fd:convertor type="formatting" variant="number">
                    <fd:patterns>
                        <fd:pattern>#,##0.00</fd:pattern>
                    </fd:patterns>
                </fd:convertor>
            </fd:datatype>
        </fd:field>
        
        <fd:field id="conversionDpUs" state="output">
            <fd:label>Conversion DP (U$):</fd:label>
            <fd:datatype base="decimal">
                <fd:convertor type="formatting" variant="number">
                    <fd:patterns>
                        <fd:pattern>#,##0.00</fd:pattern>
                    </fd:patterns>
                </fd:convertor>
            </fd:datatype>
        </fd:field>
        
        
        <fd:field id="totalRecibo" state="output">
            <fd:label>Total Recibo:</fd:label>
            <fd:datatype base="decimal">
                <fd:convertor type="formatting" variant="number">
                    <fd:patterns>
                        <fd:pattern>#,##0.00</fd:pattern>
                    </fd:patterns>
                </fd:convertor>
            </fd:datatype>
        </fd:field>
        
        <fd:field id="totalGeneral" state="output">
            <fd:label>Total General:</fd:label>
            <fd:datatype base="decimal">
                <fd:convertor type="formatting" variant="number">
                    <fd:patterns>
                        <fd:pattern>#,##0.00</fd:pattern>
                    </fd:patterns>
                </fd:convertor>
            </fd:datatype>
        </fd:field>
        
        <fd:field id="diferencia" state="output">
            <fd:label>Conversion:</fd:label>
            <fd:datatype base="decimal">
                <fd:convertor type="formatting" variant="number">
                    <fd:patterns>
                        <fd:pattern>#,##0.00</fd:pattern>
                    </fd:patterns>
                </fd:convertor>
            </fd:datatype>
        </fd:field>	

        <fd:submit id="crear">
			<fd:label>Crear</fd:label>
			<fd:help>Crear</fd:help>
			<fd:hint>Crear</fd:hint>
		</fd:submit>

   </fd:widgets>
</fd:form>