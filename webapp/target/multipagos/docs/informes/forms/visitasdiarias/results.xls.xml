<?xml version="1.0" encoding="UTF-8"?>
<document xmlns:jx="http://apache.org/cocoon/templates/jx/1.0">
    <jx:import uri="context://resources/jxmacros/jxgenerales.xml"/>

    <title>Reporte de Visitas Diarias</title>

    <columnas No="0" Unit="70"/>
    <columnas No="1" Unit="300"/>
    <columnas No="2" Unit="100"/>
    <columnas No="3" Unit="100"/>
    <columnas No="4" Unit="100"/>
    <columnas No="5" Unit="120"/>
    <columnas No="6" Unit="150"/>
    <columnas No="7" Unit="100"/>
    <columnas No="8" Unit="100"/>
    <columnas No="9" Unit="100"/>
    <columnas No="10" Unit="100"/>
    <columnas No="11" Unit="100"/>
    <columnas No="12" Unit="100"/>
    <columnas No="13" Unit="300"/>
    <columnas No="14" Unit="130"/>
    <columnas No="15" Unit="100"/>
    <columnas No="16" Unit="100"/>

    <jx:set var="fila" value="${1}"/>
    <jx:set var="col" value="${0}"/>
    <jx:set var="colFin" value="${16}"/>
    
     
    <celda Col="${col}" Row="${fila}">REPORTE DE VISITAS DIARIAS</celda>
    <estilo startCol="${col}" startRow="${fila}" endCol="${colFin}" endRow="${fila}" HAlign="64" VAlign="4" Bold="1" Unit="18"/>
	<jx:set var="fila" value="${fila+2}"/>
	
	<celda Col="${col}" Row="${fila}">Fecha de Inicio:</celda> 
    <celda Col="${col+3}" Row="${fila}"><formatoFecha fecha="${fechaIni}" patron="dd/MMM/yyyy"/></celda>
    <estilo startCol="${col}" startRow="${fila}" endCol="${col+7}" endRow="${fila}" HAlign="64" VAlign="4" Bold="1" Recuadro="1"/>
    
    <celda Col="${col+7}" Row="${fila}">Fecha Final:</celda> 
     <celda Col="${col+13}" Row="${fila}"><formatoFecha fecha="${fechaFin}" patron="dd/MMM/yyyy"/></celda>
    <estilo startCol="${col+13}" startRow="${fila}" endCol="${colFin}" endRow="${fila}" HAlign="6" VAlign="4" Bold="1" Recuadro="1"/>
    <jx:set var="fila" value="${fila+2}"/>
    
	<jx:if test="${colectorId == null}"> 
	  <celda Col="${col}" Row="${fila}">CONTRATO</celda>
      <celda Col="${col+1}" Row="${fila}">SUSCRIPTOR</celda>
      <celda Col="${col+2}" Row="${fila}">CANTIDAD FACTURA</celda>
      <celda Col="${col+3}" Row="${fila}">VALOR FACTURA</celda>
	  <celda Col="${col+4}" Row="${fila}">ACCION</celda>
      <celda Col="${col+5}" Row="${fila}">RESULTADO</celda>
      <celda Col="${col+6}" Row="${fila}">CAUSA</celda>
      <celda Col="${col+7}" Row="${fila}">FECHA VISITA</celda>
      <celda Col="${col+8}" Row="${fila}">C_RESULTADO</celda>
      <celda Col="${col+9}" Row="${fila}">C_CAUSA</celda>
      <celda Col="${col+10}" Row="${fila}">DEPARTAMENTO</celda>
      <celda Col="${col+11}" Row="${fila}">LOCALIDAD</celda>
      <celda Col="${col+12}" Row="${fila}">AVISO COBRO</celda>
      <celda Col="${col+13}" Row="${fila}">SUPERVISOR</celda>
      <celda Col="${col+14}" Row="${fila}">COLECTOR</celda>
      <celda Col="${col+15}" Row="${fila}">SERVICIO</celda>
      <celda Col="${col+16}" Row="${fila}">HORA REGISTRO</celda>
      <estilo startCol="${col}" startRow="${fila}" endCol="${colFin}" endRow="${fila}" HAlign="64" VAlign="4" Bold="1" Unit="10" Recuadro="1"/>
      <jx:set var="fila" value="${fila+1}"/>
      <jx:set var="filaIni" value="${fila}"/> 
    </jx:if>
    
    
    <jx:set var="filaInicial" value="${fila}"/>

    <jx:forEach var="item" items="${bean}" varStatus="status">
    	<jx:if test="${colector != item[13]}">    	
	               <jx:if test="${colectorId != null}">     
	        <celda Col="${col}" Row="${fila}">Colector: ${item[14]}</celda>
	        <estilo startCol="${col}" startRow="${fila}" endCol="${colFin}" endRow="${fila}" HAlign="64" VAlign="4" Bold="1" Unit="16" Recuadro="1"/>  
	        
	        <celda Col="${col}" Row="${fila}">CONTRATO</celda>
      <celda Col="${col+1}" Row="${fila}">SUSCRIPTOR</celda>
      <celda Col="${col+2}" Row="${fila}">CANTIDAD FACTURA</celda>
      <celda Col="${col+3}" Row="${fila}">VALOR FACTURA</celda>
	  <celda Col="${col+4}" Row="${fila}">ACCION</celda>
      <celda Col="${col+5}" Row="${fila}">RESULTADO</celda>
      <celda Col="${col+6}" Row="${fila}">CAUSA</celda>
      <celda Col="${col+7}" Row="${fila}">FECHA VISITA</celda>
      <celda Col="${col+8}" Row="${fila}">C_RESULTADO</celda>
      <celda Col="${col+9}" Row="${fila}">C_CAUSA</celda>
      <celda Col="${col+10}" Row="${fila}">DEPARTAMENTO</celda>
      <celda Col="${col+11}" Row="${fila}">LOCALIDAD</celda>
      <celda Col="${col+12}" Row="${fila}">AVISO COBRO</celda>
      <celda Col="${col+13}" Row="${fila}">SUPERVISOR</celda>
      <!--<celda Col="${col+14}" Row="${fila}">COLECTOR</celda>-->
      <celda Col="${col+15}" Row="${fila}">SERVICIO</celda>
      <celda Col="${col+16}" Row="${fila}">HORA REGISTRO</celda>
      <estilo startCol="${col}" startRow="${fila}" endCol="${colFin}" endRow="${fila}" HAlign="64" VAlign="4" Bold="1" Unit="10" Recuadro="1"/>
      <jx:set var="fila" value="${fila+1}"/>
      <jx:set var="filaIni" value="${fila}"/> 
      
        </jx:if>
 </jx:if>
    
	    <celda Col="${col}" Row="${fila}">${item[0]}</celda>
	    <celda Col="${col+1}" Row="${fila}">${item[1]}</celda>
	    <celda Col="${col+2}" Row="${fila}">${item[2]}</celda>
	    <celda Col="${col+3}" Row="${fila}"><formatoNumero numero="${item[3]}"/></celda>
	    <celda Col="${col+4}" Row="${fila}">Visita de Cobro</celda>
	    <celda Col="${col+5}" Row="${fila}">${item[4]}</celda>
	    <celda Col="${col+6}" Row="${fila}">${item[5]}</celda>
	    <celda Col="${col+7}" Row="${fila}"><formatoFecha fecha="${item[6]}" patron="dd/MMM/yyyy"/></celda>
	    <celda Col="${col+8}" Row="${fila}">${item[7]}</celda>
	    <celda Col="${col+9}" Row="${fila}">${item[8]}</celda>
	    <celda Col="${col+10}" Row="${fila}">${item[9]}</celda>
		<celda Col="${col+11}" Row="${fila}">${item[10]}</celda>
	    <celda Col="${col+12}" Row="${fila}">${item[11]}</celda>
	    <celda Col="${col+13}" Row="${fila}">${item[12]}</celda>
	    <jx:if test="${colectorId == null}">
	    	<celda Col="${col+14}" Row="${fila}" align="left">${item[14]}</celda>
	    </jx:if>
	    <celda Col="${col+15}" Row="${fila}">${item[15]}</celda>
	    <celda Col="${col+16}" Row="${fila}">${item[16]}</celda>
	    <estilo startCol="${col}" startRow="${fila}" endCol="${colFin}" endRow="${fila}" HAlign="64" VAlign="4" Recuadro="1"/>    
	    <jx:set var="fila" value="${fila+1}"/>
	
	    <jx:if test="${status.last}">      
	        <celda Col="${col}" Row="${fila}">Total Visitas</celda>
	        <estilo startCol="${col}" startRow="${fila}" endCol="${col+9}" endRow="${fila}" HAlign="64" VAlign="4" Bold="1" Recuadro="1"/>
	        <celda Col="${col+9}" Row="${fila}" ValueType="flotante" patron="#,##0"><jx:formatNumber value="${status.count}"/></celda>
	        <estilo  startCol="${col+9}" startRow="${fila}" endCol="${colFin}" endRow="${fila}" Recuadro="1" Bold="1" Unit="18" Format="#,##0"/>
	         <jx:set var="fila" value="${fila+1}"/>        
	    </jx:if>
    </jx:forEach>
</document>